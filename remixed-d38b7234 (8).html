<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crossword Search Puzzle</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            margin: 20px;
            background: #f8f8f8;
        }
        
        body.print-mode .settings-panel,
        body.print-mode .controls button:not(#printModeBtn),
        body.print-mode .subtitle,
        body.print-mode .stats {
            display: none !important;
        }
        
        body.print-mode .main-content {
            justify-content: center;
        }
        
        body.print-mode {
            background: white;
        }
        
        body.print-mode .container {
            box-shadow: none;
        }
        
        .container.clues-alongside .main-content {
            align-items: flex-start;
        }
        
        .container.clues-alongside .clues-grid {
            grid-template-columns: 1fr;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 0px;
            font-family: 'Georgia', serif;
            font-size: 22px;
            display: inline-block;
        }
        
        .subtitle {
            display: none;
        }
        
        .header-row {
            text-align: center;
            margin-bottom: 10px;
        }
        
        .kofi-container {
            display: inline-block;
            margin: 0;
        }
        
        .kofi-button {
            display: inline-block;
            padding: 12px 24px;
            background: #72a4f2;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 16px;
            transition: background 0.3s;
            font-family: 'Georgia', serif;
            margin: 0 5px;
        }
        
        .kofi-button:hover {
            background: #5a8dd9;
        }
        
        .main-content {
            display: flex;
            gap: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .settings-panel {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            width: 280px;
            height: fit-content;
        }
        
        .settings-panel h3 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }
        
        .setting-group {
            margin-bottom: 20px;
        }
        
        .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
        }
        
        .setting-group label input[type="checkbox"] {
            margin-right: 8px;
        }
        
        .slider {
            width: 100%;
            margin-bottom: 5px;
        }
        
        .setting-value {
            font-size: 12px;
            color: #7f8c8d;
            text-align: center;
        }
        
        input[type="text"], textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .grid-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .grid {
            display: inline-grid;
            gap: 0;
            border: 2px solid #2c3e50;
            background: white;
            margin: 10px 0;
            padding: 0;
        }
        
        .cell {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #ecf0f1;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            background: white;
        }
        
        .cell:hover {
            background: #e8f4f8;
            transform: scale(1.1);
            z-index: 10;
        }
        
        .cell.highlighted {
            background: #f1c40f !important;
            color: #2c3e50;
            font-weight: bold;
            border: 1px solid #f39c12;
        }
        
        .clues-list {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            max-width: 1400px;
            margin: 10px auto;
        }
        
        .container.clues-alongside .clues-list {
            max-width: 450px;
            width: 450px;
            margin: 0;
            flex-shrink: 0;
        }
        
        .clues-list h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
            text-align: center;
            font-size: 18px;
        }
        
        .clues-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .clue-item {
            margin-bottom: 0;
            padding: 8px;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #bdc3c7;
            transition: all 0.3s;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .clue-item.found {
            background: #d4edda;
            border-left-color: #28a745;
        }
        
        .clue-number {
            font-weight: bold;
            color: #3498db;
            font-size: 13px;
        }
        
        .clue-text {
            margin: 4px 0;
            color: #2c3e50;
            line-height: 1.6;
            font-size: 14px;
        }
        
        .clue-hint {
            font-size: 11px;
            color: #7f8c8d;
            margin-top: 4px;
        }
        
        .clue-answer {
            font-size: 12px;
            color: #27ae60;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e0e0e0;
        }
        
        .direction-icon {
            display: inline-block;
            font-weight: bold;
            color: #3498db;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 5px;
            transition: background 0.3s;
            font-family: 'Georgia', serif;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .stats {
            text-align: center;
            margin: 10px 0;
            color: #7f8c8d;
            font-size: 16px;
        }
        
        .current-theme {
            text-align: center;
            margin: 10px 0;
            padding: 12px;
            background: #d4edda;
            border-radius: 8px;
            color: #155724;
            font-weight: bold;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .modal-header h2 {
            margin: 0;
            color: #2c3e50;
        }
        
        .close-btn {
            background: #e74c3c;
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .close-btn:hover {
            background: #c0392b;
        }
        
        .clue-editor {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #3498db;
        }
        
        .clue-editor label {
            display: block;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .clue-editor input {
            width: 100%;
            margin-bottom: 10px;
        }
        
        .clue-editor-word {
            font-size: 18px;
            color: #3498db;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .modal-actions {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
        
        @media print {
            .settings-panel, .controls, .modal, .stats, .subtitle, .kofi-container {
                display: none !important;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
                padding: 5px;
            }
            
            body {
                background: white;
                margin: 0;
            }
            
            h1 {
                font-size: 18px;
                margin-bottom: 0;
            }
            
            .header-row {
                margin-bottom: 8px;
            }
            
            .current-theme {
                font-size: 12px;
                padding: 3px 10px;
                margin-left: 10px;
            }
            
            .cell.highlighted {
                background: white !important;
            }
            
            .clues-list {
                background: white;
                page-break-before: avoid;
                padding: 8px 0;
                margin: 5px 0;
            }
            
            .clues-list h3 {
                font-size: 15px;
                margin-bottom: 8px;
            }
            
            .clue-answer {
                display: none !important;
            }
            
            .grid-container {
                page-break-inside: avoid;
            }
            
            .grid {
                margin: 5px 0;
            }
            
            .clues-grid {
                gap: 5px;
                grid-template-columns: 1fr 1fr;
            }
            
            .clue-item {
                padding: 5px;
                margin-bottom: 0;
                page-break-inside: avoid;
                font-size: 11px;
                line-height: 1.4;
            }
            
            .clue-text {
                font-size: 11px;
                line-height: 1.4;
            }
            
            .clue-number {
                font-size: 11px;
            }
            
            .clue-hint {
                font-size: 9px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-row">
            <h1>Crossword Search Puzzle</h1>
            <div id="currentTheme" class="current-theme">Theme: Classic Literature</div>
        </div>
        
        <div class="main-content">
            <div class="settings-panel">
                <h3>Puzzle Settings</h3>
                
                <div class="setting-group">
                    <label>Theme Name:</label>
                    <input type="text" id="themeInput" value="Classic Literature">
                </div>
                
                <div class="setting-group">
                    <button id="editCluesBtn" style="width: 100%; background: #9b59b6;">Edit Clues</button>
                </div>
                
                <div class="setting-group">
                    <label>Grid Size:</label>
                    <input type="range" class="slider" id="sizeSlider" min="10" max="20" value="15">
                    <div class="setting-value" id="sizeValue">15×15 grid</div>
                </div>
                
                <div class="setting-group">
                    <label>Puzzle Display Size:</label>
                    <input type="range" class="slider" id="displaySizeSlider" min="20" max="50" value="30">
                    <div class="setting-value" id="displaySizeValue">30px cells</div>
                </div>
                
                <div class="setting-group">
                    <label>Clue Font Size:</label>
                    <input type="range" class="slider" id="clueFontSlider" min="10" max="20" value="14">
                    <div class="setting-value" id="clueFontValue">14px font</div>
                </div>
                
                <div class="setting-group">
                    <label>Clue Position:</label>
                    <select id="cluePositionSelect">
                        <option value="below">Below Puzzle</option>
                        <option value="alongside">Alongside Puzzle</option>
                    </select>
                </div>
            </div>
            
            <div class="game-area">
                <div class="controls">
                    <button id="printModeBtn">Print Mode</button>
                    <button id="revealBtn">Reveal All</button>
                    <button id="newPuzzleBtn">New Puzzle</button>
                    <a href="https://ko-fi.com/C0C6HVPI6" target="_blank" class="kofi-button">☕ Support me on Ko-fi</a>
                </div>
                
                <div class="grid-container">
                    <div class="grid" id="wordGrid"></div>
                </div>
            </div>
        </div>
        
        <div class="clues-list">
            <h3>Clues</h3>
            <div class="clues-grid" id="cluesList"></div>
        </div>
    </div>
    
    <!-- Clue Editor Modal -->
    <div id="clueEditorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Words & Clues</h2>
                <button class="close-btn" id="closeEditorBtn">Close</button>
            </div>
            <div id="clueEditorContent"></div>
            <div class="modal-actions">
                <button id="saveCluesBtn" style="background: #27ae60; padding: 12px 30px;">Save & Generate Puzzle</button>
                <button id="addWordBtn" style="background: #9b59b6; padding: 12px 30px;">Add New Word</button>
            </div>
        </div>
    </div>

    <script>
        let GRID_SIZE = 15;
        let grid = [];
        let placedWords = [];
        let revealMode = false;
        let currentTheme = "Classic Literature";
        let printMode = false;
        let cluesPosition = 'below';
        let cellSize = 30;
        let clueFontSize = 14;
        
        // Default words for Classic Literature theme
        let wordList = [
            { word: 'HAMLET', clue: 'Melancholy Danish royal in Shakespeare' },
            { word: 'GATSBY', clue: 'Fitzgerald\'s "Great" millionaire' },
            { word: 'ODYSSEY', clue: 'Homer\'s epic voyage home' },
            { word: 'PRIDE', clue: '___ and Prejudice (Austen novel)' },
            { word: 'MOCKINGBIRD', clue: 'Lee\'s "To Kill a ___"' },
            { word: 'BRAVE', clue: '___ New World (Huxley)' },
            { word: 'WUTHERING', clue: '___ Heights (Brontë)' },
            { word: 'SCARLET', clue: 'The ___ Letter (Hawthorne)' },
            { word: 'EYRE', clue: 'Jane ___ (Brontë heroine)' },
            { word: 'MOBY', clue: '___ Dick (Melville\'s whale)' }
        ];
        
        // Directions with symbols
        const directions = [
            { delta: [0, 1], name: 'Right', symbol: '→' },
            { delta: [0, -1], name: 'Left', symbol: '←' },
            { delta: [1, 0], name: 'Down', symbol: '↓' },
            { delta: [-1, 0], name: 'Up', symbol: '↑' },
            { delta: [1, 1], name: 'Diagonal Down-Right', symbol: '↘' },
            { delta: [-1, -1], name: 'Diagonal Up-Left', symbol: '↖' },
            { delta: [1, -1], name: 'Diagonal Down-Left', symbol: '↙' },
            { delta: [-1, 1], name: 'Diagonal Up-Right', symbol: '↗' }
        ];
        
        // Modal functions
        function openClueEditor() {
            const modal = document.getElementById('clueEditorModal');
            const content = document.getElementById('clueEditorContent');
            content.innerHTML = '';
            
            wordList.forEach((item, index) => {
                const editor = document.createElement('div');
                editor.className = 'clue-editor';
                editor.innerHTML = `
                    <div class="clue-editor-word">Word ${index + 1}</div>
                    <label>Word (letters only):</label>
                    <input type="text" class="word-input" data-index="${index}" value="${item.word}" placeholder="Enter word">
                    <label>Clue:</label>
                    <input type="text" class="clue-input" data-index="${index}" value="${item.clue}" placeholder="Enter clue">
                    <button class="remove-word-btn" data-index="${index}" style="background: #e74c3c; padding: 8px 16px; font-size: 14px; margin-top: 5px;">Remove</button>
                `;
                content.appendChild(editor);
            });
            
            // Add event listeners for remove buttons
            document.querySelectorAll('.remove-word-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    removeWord(parseInt(this.dataset.index));
                });
            });
            
            modal.classList.add('active');
        }
        
        function closeClueEditor() {
            document.getElementById('clueEditorModal').classList.remove('active');
        }
        
        function addNewWord() {
            // First, save current entries from the modal
            const wordInputs = document.querySelectorAll('.word-input');
            const clueInputs = document.querySelectorAll('.clue-input');
            
            if (wordInputs.length > 0) {
                const updatedWordList = [];
                
                wordInputs.forEach((wordInput, index) => {
                    const word = wordInput.value.trim().toUpperCase();
                    const clue = clueInputs[index].value.trim();
                    
                    // Keep all entries, even if empty
                    updatedWordList.push({ 
                        word: word || '', 
                        clue: clue || '' 
                    });
                });
                
                wordList = updatedWordList;
            }
            
            // Now add a new empty word
            wordList.push({ word: '', clue: '' });
            openClueEditor();
        }
        
        function removeWord(index) {
            if (wordList.length <= 1) {
                alert('You must have at least one word!');
                return;
            }
            
            // First, save current entries from the modal
            const wordInputs = document.querySelectorAll('.word-input');
            const clueInputs = document.querySelectorAll('.clue-input');
            
            if (wordInputs.length > 0) {
                const updatedWordList = [];
                
                wordInputs.forEach((wordInput, idx) => {
                    const word = wordInput.value.trim().toUpperCase();
                    const clue = clueInputs[idx].value.trim();
                    
                    // Keep all entries except the one being removed
                    if (idx !== index) {
                        updatedWordList.push({ 
                            word: word || '', 
                            clue: clue || '' 
                        });
                    }
                });
                
                wordList = updatedWordList;
            } else {
                wordList.splice(index, 1);
            }
            
            openClueEditor();
        }
        
        function saveClues() {
            const newWordList = [];
            const wordInputs = document.querySelectorAll('.word-input');
            const clueInputs = document.querySelectorAll('.clue-input');
            
            wordInputs.forEach((wordInput, index) => {
                const word = wordInput.value.trim().toUpperCase();
                const clue = clueInputs[index].value.trim();
                
                if (word && clue && /^[A-Z]+$/.test(word)) {
                    newWordList.push({ word, clue });
                }
            });
            
            if (newWordList.length === 0) {
                alert('Please enter at least one valid word and clue!');
                return;
            }
            
            wordList = newWordList;
            closeClueEditor();
            resetPuzzle();
            
            const theme = document.getElementById('currentTheme');
            theme.textContent = `Saved ${wordList.length} words!`;
            theme.style.background = '#d4edda';
            theme.style.color = '#155724';
            setTimeout(() => {
                theme.textContent = `Theme: ${currentTheme}`;
            }, 2000);
        }
        
        // Grid functions
        function initializeGrid() {
            GRID_SIZE = parseInt(document.getElementById('sizeSlider').value);
            
            grid = [];
            for (let i = 0; i < GRID_SIZE; i++) {
                grid[i] = [];
                for (let j = 0; j < GRID_SIZE; j++) {
                    grid[i][j] = '';
                }
            }
        }
        
        function canPlaceWord(word, row, col, direction) {
            const [dr, dc] = direction.delta;
            
            for (let i = 0; i < word.length; i++) {
                const newRow = row + i * dr;
                const newCol = col + i * dc;
                
                if (newRow < 0 || newRow >= GRID_SIZE || newCol < 0 || newCol >= GRID_SIZE) {
                    return false;
                }
                
                if (grid[newRow][newCol] !== '' && grid[newRow][newCol] !== word[i]) {
                    return false;
                }
            }
            return true;
        }
        
        function placeWord(wordObj, row, col, direction) {
            const word = wordObj.word;
            const clue = wordObj.clue;
            const [dr, dc] = direction.delta;
            const positions = [];
            
            for (let i = 0; i < word.length; i++) {
                const newRow = row + i * dr;
                const newCol = col + i * dc;
                grid[newRow][newCol] = word[i];
                positions.push([newRow, newCol]);
            }
            
            placedWords.push({
                word: word,
                clue: clue,
                positions: positions,
                found: false,
                startRow: row + 1,
                startCol: col + 1,
                direction: direction
            });
        }
        
        function tryPlaceWord(wordObj) {
            const word = wordObj.word;
            const maxAttempts = 200;
            
            for (let attempt = 0; attempt < maxAttempts; attempt++) {
                const direction = directions[Math.floor(Math.random() * directions.length)];
                const row = Math.floor(Math.random() * GRID_SIZE);
                const col = Math.floor(Math.random() * GRID_SIZE);
                
                if (canPlaceWord(word, row, col, direction)) {
                    placeWord(wordObj, row, col, direction);
                    return true;
                }
            }
            return false;
        }
        
        function fillEmptySpaces() {
            const commonLetters = 'EARIOTNSHLRUDCMFWGPBVKJXQZ';
            
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    if (grid[i][j] === '') {
                        grid[i][j] = commonLetters[Math.floor(Math.random() * commonLetters.length)];
                    }
                }
            }
        }
        
        function generatePuzzle() {
            initializeGrid();
            placedWords = [];
            
            const wordsToPlace = [...wordList].sort((a, b) => b.word.length - a.word.length);
            
            wordsToPlace.forEach(wordObj => {
                tryPlaceWord(wordObj);
            });
            
            fillEmptySpaces();
            renderGrid();
            renderClues();
            updateStats();
        }
        
        function renderGrid() {
            const gridElement = document.getElementById('wordGrid');
            gridElement.innerHTML = '';
            gridElement.style.gridTemplateColumns = `repeat(${GRID_SIZE}, ${cellSize}px)`;
            
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.textContent = grid[i][j];
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.style.width = `${cellSize}px`;
                    cell.style.height = `${cellSize}px`;
                    cell.style.fontSize = `${Math.floor(cellSize * 0.6)}px`;
                    gridElement.appendChild(cell);
                }
            }
        }
        
        function renderClues() {
            const cluesElement = document.getElementById('cluesList');
            cluesElement.innerHTML = '';
            
            placedWords.forEach((wordObj, index) => {
                const clueDiv = document.createElement('div');
                clueDiv.className = 'clue-item';
                clueDiv.dataset.index = index;
                clueDiv.style.fontSize = `${clueFontSize}px`;
                
                const clueNumber = document.createElement('div');
                clueNumber.className = 'clue-number';
                clueNumber.textContent = `${index + 1}.`;
                clueNumber.style.fontSize = `${Math.floor(clueFontSize * 0.92)}px`;
                
                const clueText = document.createElement('div');
                clueText.className = 'clue-text';
                clueText.textContent = wordObj.clue;
                clueText.style.fontSize = `${clueFontSize}px`;
                
                const clueHint = document.createElement('div');
                clueHint.className = 'clue-hint';
                clueHint.innerHTML = `
                    <span class="direction-icon">${wordObj.direction.symbol}</span>
                    ${wordObj.word.length} letters • 
                    ${wordObj.direction.name}
                `;
                clueHint.style.fontSize = `${Math.floor(clueFontSize * 0.77)}px`;
                
                const answerReveal = document.createElement('div');
                answerReveal.className = 'clue-answer';
                answerReveal.style.display = 'none';
                answerReveal.innerHTML = `<strong>Answer:</strong> ${wordObj.word}`;
                
                clueDiv.appendChild(clueNumber);
                clueDiv.appendChild(clueText);
                clueDiv.appendChild(clueHint);
                clueDiv.appendChild(answerReveal);
                cluesElement.appendChild(clueDiv);
            });
        }
        
        function updateClueFontSize() {
            const clueItems = document.querySelectorAll('.clue-item');
            clueItems.forEach(item => {
                item.style.fontSize = `${clueFontSize}px`;
            });
            
            const clueTexts = document.querySelectorAll('.clue-text');
            clueTexts.forEach(text => {
                text.style.fontSize = `${clueFontSize}px`;
            });
            
            const clueNumbers = document.querySelectorAll('.clue-number');
            clueNumbers.forEach(num => {
                num.style.fontSize = `${Math.floor(clueFontSize * 0.92)}px`;
            });
            
            const clueHints = document.querySelectorAll('.clue-hint');
            clueHints.forEach(hint => {
                hint.style.fontSize = `${Math.floor(clueFontSize * 0.77)}px`;
            });
        }
        
        function updateCluePosition() {
            cluesPosition = document.getElementById('cluePositionSelect').value;
            const container = document.querySelector('.container');
            const mainContent = document.querySelector('.main-content');
            const cluesList = document.querySelector('.clues-list');
            
            if (cluesPosition === 'alongside') {
                container.classList.add('clues-alongside');
                if (!mainContent.contains(cluesList)) {
                    mainContent.appendChild(cluesList);
                }
            } else {
                container.classList.remove('clues-alongside');
                if (mainContent.contains(cluesList)) {
                    container.appendChild(cluesList);
                }
            }
        }
        
        function togglePrintMode() {
            printMode = !printMode;
            const btn = document.getElementById('printModeBtn');
            
            if (printMode) {
                document.body.classList.add('print-mode');
                btn.textContent = 'Exit Print Mode';
                btn.style.background = '#e74c3c';
            } else {
                document.body.classList.remove('print-mode');
                btn.textContent = 'Print Mode';
                btn.style.background = '#3498db';
            }
        }
        
        function toggleReveal() {
            revealMode = !revealMode;
            const btn = document.getElementById('revealBtn');
            
            if (revealMode) {
                btn.textContent = 'Hide All';
                highlightAllWords();
            } else {
                btn.textContent = 'Reveal All';
                clearHighlights();
            }
        }
        
        function highlightAllWords() {
            clearHighlights();
            
            placedWords.forEach((wordObj, index) => {
                wordObj.positions.forEach(([row, col]) => {
                    const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                    if (cell) {
                        cell.classList.add('highlighted');
                    }
                });
                
                const clueItem = document.querySelector(`[data-index="${index}"]`);
                if (clueItem) {
                    clueItem.classList.add('found');
                    const answerDiv = clueItem.querySelector('.clue-answer');
                    if (answerDiv) {
                        answerDiv.style.display = 'block';
                    }
                }
                
                wordObj.found = true;
            });
            
            updateStats();
        }
        
        function clearHighlights() {
            document.querySelectorAll('.cell').forEach(cell => {
                cell.classList.remove('highlighted');
            });
            
            document.querySelectorAll('.clue-item').forEach(item => {
                item.classList.remove('found');
                const answerDiv = item.querySelector('.clue-answer');
                if (answerDiv) {
                    answerDiv.style.display = 'none';
                }
            });
            
            placedWords.forEach(wordObj => {
                wordObj.found = false;
            });
            
            updateStats();
        }
        
        function updateStats() {
            const foundCount = placedWords.filter(w => w.found).length;
            const totalWords = placedWords.length;
            
            const foundElement = document.getElementById('foundCount');
            const totalElement = document.getElementById('totalWords');
            
            if (foundElement) foundElement.textContent = foundCount;
            if (totalElement) totalElement.textContent = totalWords;
        }
        
        function resetPuzzle() {
            revealMode = false;
            document.getElementById('revealBtn').textContent = 'Reveal All';
            generatePuzzle();
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Slider listeners
            document.getElementById('sizeSlider').addEventListener('input', function() {
                document.getElementById('sizeValue').textContent = `${this.value}×${this.value} grid`;
            });
            
            document.getElementById('displaySizeSlider').addEventListener('input', function() {
                cellSize = parseInt(this.value);
                document.getElementById('displaySizeValue').textContent = `${cellSize}px cells`;
                renderGrid();
            });
            
            document.getElementById('clueFontSlider').addEventListener('input', function() {
                clueFontSize = parseInt(this.value);
                document.getElementById('clueFontValue').textContent = `${clueFontSize}px font`;
                updateClueFontSize();
            });
            
            // Theme input
            document.getElementById('themeInput').addEventListener('change', function() {
                currentTheme = this.value || "Custom Puzzle";
                document.getElementById('currentTheme').textContent = `Theme: ${currentTheme}`;
            });
            
            // Button listeners
            document.getElementById('editCluesBtn').addEventListener('click', openClueEditor);
            document.getElementById('closeEditorBtn').addEventListener('click', closeClueEditor);
            document.getElementById('saveCluesBtn').addEventListener('click', saveClues);
            document.getElementById('addWordBtn').addEventListener('click', addNewWord);
            document.getElementById('printModeBtn').addEventListener('click', togglePrintMode);
            document.getElementById('revealBtn').addEventListener('click', toggleReveal);
            document.getElementById('newPuzzleBtn').addEventListener('click', resetPuzzle);
            document.getElementById('cluePositionSelect').addEventListener('change', updateCluePosition);
            
            // Initialize the puzzle
            generatePuzzle();
        });
    </script>
</body>
</html>